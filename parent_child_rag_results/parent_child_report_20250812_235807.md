# çˆ¶å­åˆ†å—RAGå¤„ç†æŠ¥å‘Š

## åŸºæœ¬ä¿¡æ¯
- **æ–‡ä»¶**: data/reports/600580_å§é¾™ç”µé©±2025-04-26_å§é¾™ç”µé©±2024å¹´å¹´åº¦æŠ¥å‘Š_2105.pdf
- **å¤„ç†æ—¶é—´**: 2025-08-12T23:58:07.829030
- **å¤„ç†æ–¹æ³•**: parent_child_rag

## åˆ†å—ç»Ÿè®¡
- **å­åˆ†å—æ€»æ•°**: 313
  - è¡¨æ ¼å­åˆ†å—: 313
  - æ–‡æœ¬å­åˆ†å—: 0
- **çˆ¶åˆ†å—æ€»æ•°**: 64
- **è·³è¿‡çš„è¡¨æ ¼åŒºåŸŸ**: 313

## çˆ¶å­åˆ†å—RAGæ¶æ„

### ğŸ¯ å¤„ç†æµç¨‹
1. **é«˜ä¿çœŸè¡¨æ ¼æå–** - pdfplumberæå–313ä¸ªè¡¨æ ¼ï¼Œè½¬ä¸ºMarkdownå­åˆ†å—
2. **é«˜ä¿çœŸæ–‡æœ¬æå–** - unstructuredè·³è¿‡313ä¸ªè¡¨æ ¼åŒºåŸŸï¼Œæå–æ–‡æœ¬å…ƒç´ 
3. **æ–‡æœ¬äºŒæ¬¡åˆ†å—** - é€’å½’åˆ†å—ç”Ÿæˆ0ä¸ªæ–‡æœ¬å­åˆ†å—
4. **æ„å»ºçˆ¶å­å…³ç³»** - åˆ›å»º64ä¸ªçˆ¶åˆ†å—ï¼Œå…³è”æ‰€æœ‰å­åˆ†å—
5. **RAGå­˜å‚¨å‡†å¤‡** - å­åˆ†å—ç”¨äºå‘é‡åŒ–ï¼Œçˆ¶åˆ†å—ç”¨äºä¸Šä¸‹æ–‡æ£€ç´¢

### ğŸ“Š å­˜å‚¨æ¶æ„
- **å‘é‡æ•°æ®åº“**: å­˜å‚¨313ä¸ªå­åˆ†å—çš„å‘é‡è¡¨ç¤º
- **æ–‡æ¡£å­˜å‚¨**: å­˜å‚¨64ä¸ªçˆ¶åˆ†å—çš„å®Œæ•´å†…å®¹ï¼ˆé”®å€¼å¯¹ï¼‰

### ğŸ” æ£€ç´¢æµç¨‹
1. ç”¨æˆ·æé—® â†’ å‘é‡æ•°æ®åº“æ£€ç´¢ç›¸å…³å­åˆ†å—
2. ä»å­åˆ†å—å…ƒæ•°æ®æå–çˆ¶åˆ†å—ID
3. ä»æ–‡æ¡£å­˜å‚¨è·å–çˆ¶åˆ†å—å®Œæ•´å†…å®¹
4. å°†çˆ¶åˆ†å—å†…å®¹æäº¤ç»™LLMç”Ÿæˆç­”æ¡ˆ

## é…ç½®å‚æ•°
- **å­åˆ†å—å¤§å°**: 800
- **å­åˆ†å—é‡å **: 100
- **çˆ¶åˆ†å—ç­–ç•¥**: page_group
- **æ¯ç»„é¡µæ•°**: 3

## RAGç³»ç»Ÿé›†æˆæŒ‡å—

### 1. å‘é‡æ•°æ®åº“å­˜å‚¨
```python
# å­˜å‚¨å­åˆ†å—åˆ°å‘é‡æ•°æ®åº“
for child_chunk in result['child_chunks']:
    vector = embed_text(child_chunk['content'])
    vector_db.store(
        id=child_chunk['chunk_id'],
        vector=vector,
        metadata=child_chunk['metadata']
    )
```

### 2. æ–‡æ¡£å­˜å‚¨
```python
# å­˜å‚¨çˆ¶åˆ†å—åˆ°æ–‡æ¡£å­˜å‚¨
for parent_id, parent_data in result['parent_chunks'].items():
    doc_store[parent_id] = parent_data['content']
```

### 3. æ£€ç´¢æŸ¥è¯¢
```python
# æ£€ç´¢æµç¨‹
def query_rag(question):
    # 1. æ£€ç´¢ç›¸å…³å­åˆ†å—
    child_chunks = vector_db.search(question, top_k=5)
    
    # 2. è·å–çˆ¶åˆ†å—ID
    parent_ids = [chunk['metadata']['parent_id'] for chunk in child_chunks]
    
    # 3. è·å–çˆ¶åˆ†å—å®Œæ•´å†…å®¹
    parent_contents = [doc_store[pid] for pid in set(parent_ids)]
    
    # 4. ç”Ÿæˆç­”æ¡ˆ
    return llm.generate(question, parent_contents)
```

## ä¼˜åŠ¿ç‰¹ç‚¹
- âœ… **é«˜ä¿çœŸæå–**: è¡¨æ ¼å’Œæ–‡æœ¬éƒ½ä¿æŒåŸå§‹ç»“æ„
- âœ… **é¿å…é‡å¤**: unstructuredè·³è¿‡è¡¨æ ¼åŒºåŸŸï¼Œé¿å…é‡å¤å¤„ç†
- âœ… **ç»†ç²’åº¦æ£€ç´¢**: å­åˆ†å—æä¾›ç²¾ç¡®çš„å‘é‡æ£€ç´¢
- âœ… **ä¸°å¯Œä¸Šä¸‹æ–‡**: çˆ¶åˆ†å—æä¾›å®Œæ•´çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
- âœ… **çµæ´»é…ç½®**: æ”¯æŒå¤šç§çˆ¶åˆ†å—ç­–ç•¥
- âœ… **RAGä¼˜åŒ–**: ä¸“é—¨ä¸ºRAGç³»ç»Ÿè®¾è®¡çš„å­˜å‚¨æ¶æ„

